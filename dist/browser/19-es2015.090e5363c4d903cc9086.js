(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{JSOT:function(n,l,t){"use strict";t.r(l);var o=t("8Y7J");class e{}var i=t("pMnS"),a=t("SVse"),c=t("NvT6"),s=t("W5yJ"),u=t("/HVE"),r=t("omvX"),b=t("FbN9"),d=t("BzsH"),p=t("2/pp"),v=t("xQwi"),h=t("VYsW"),m=t("ZJFI"),g=t("Mr+X"),f=t("Gi4r");class k{constructor(n,l,t){this.videoPlayer=n,this.router=l,this.appContext=t,this.startBlock=!1,this.icons={video:["video-off","video"],audio:["audio-off","audio"]},this.video=this.icons.video[1],this.audio=this.icons.audio[1]}ngOnInit(){this.context.className.active=!0}startVisual(){Object.keys(this.context.visual).sort((n,l)=>+n-+l).forEach(n=>{let l=setTimeout(()=>{let t=this.context.visual[n];this.video=this.icons.video[t.video],this.audio=this.icons.audio[t.audio],this.appContext.appChangeRef.markForCheck(),clearTimeout(l)},+n-this.context.startTime)})}onErrorVideo(n){}onLoadedData(){this.startBlock=!0,this.context.visual&&this.startVisual(),this.appContext.appChangeRef.markForCheck()}onEnded(){this.startBlock=this.context.className.fixed=this.context.className.active=!1;let n=this.videoPlayer.activeVideoBlocks.value.filter(n=>n.uid!==this.context.uid);n.length<2&&this.router.navigateByUrl("/application/main/messages"),this.videoPlayer.activeVideoBlocks.next(n),this.appContext.appChangeRef.markForCheck()}}var A=t("2Vo4");class x{constructor(n,l,t,o,e){this.appContext=n,this.changeRef=l,this.sanitizer=t,this.router=o,this.route=e,this.dataLoaded=!1,this.stopActive=!1,this.activeVideoBlocks=new A.a([])}ngOnInit(){let n=this;this.activeVideoBlocks.subscribe(n=>{n.forEach(l=>{l.local&&(l.className.fixed=n.length>1)})}),this.route.data.subscribe(l=>{let t=Math.min(...Object.values(l.messageData.map(n=>n.mess.startTime)));l.messageData.forEach(l=>{let o=setTimeout(()=>{let t=n.activeVideoBlocks.value;t.push({startTime:l.mess.startTime,visual:l.mess.visual,src:n.sanitizer.bypassSecurityTrustUrl(URL.createObjectURL(l.result)),uid:l.mess.uid,local:l.mess.local,contact:l.mess.local?n.appContext.activeMessage.sender:n.appContext.activeMessage.receivers.find(n=>n.uid===l.mess.uid),className:{local:l.mess.local,[l.mess.uid]:!0,false:!0,fixed:!1}}),n.activeVideoBlocks.next(t),clearTimeout(o),n.appContext.appChangeRef.markForCheck()},l.mess.startTime-t)})})}onClickOverlay(n){this.stopActive=!1,n.stopPropagation(),this.changeRef.detectChanges()}onClickButton(){this.router.navigateByUrl("/application/main/messages")}onClickHost(){if(!this.stopActive){this.stopActive=!0;let n=setTimeout(()=>{clearTimeout(n),this.stopActive=!1},4e3)}}}var C=t("iInd"),y=o.ob({encapsulation:0,styles:[["div.video-block-container.local.active.fixed[_ngcontent-%COMP%]{position:absolute;left:0;bottom:0;width:200px;height:200px;z-index:5}div.video-block-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:row;width:100%;height:100%;position:relative;transition:all .3s}.active-video-block[_ngcontent-%COMP%]{width:100%;height:100%}.video-block-toolbar[_ngcontent-%COMP%]{z-index:6;position:absolute;top:0;left:0;background:0 0;color:#fff}video.video-element[_ngcontent-%COMP%]{position:absolute;z-index:0;top:0;left:0;width:100%;height:100%;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 50%;object-position:50% 50%}.video-block-spinner[_ngcontent-%COMP%]{position:absolute}div.video-metadata-container.local.active.fixed[_nghost-%COMP%]     .contact-name, div.video-metadata-container.local.active.fixed   [_nghost-%COMP%]     .contact-name{display:none}"]],data:{}});function w(n){return o.Lb(0,[(n()(),o.qb(0,0,null,null,1,"mat-spinner",[["class","video-block-spinner mat-spinner mat-progress-spinner"],["mode","indeterminate"],["role","progressbar"]],[[2,"_mat-animation-noopable",null],[4,"width","px"],[4,"height","px"]],null,null,c.d,c.b)),o.pb(1,114688,null,0,s.d,[o.k,u.a,[2,a.d],[2,r.a],s.a],null,null)],(function(n,l){n(l,1,0)}),(function(n,l){n(l,0,0,o.Cb(l,1)._noopAnimations,o.Cb(l,1).diameter,o.Cb(l,1).diameter)}))}function O(n){return o.Lb(0,[(n()(),o.qb(0,0,null,null,11,"div",[["class","active-video-block"]],null,null,null,null,null)),(n()(),o.qb(1,0,null,null,9,"mat-toolbar",[["class","video-block-toolbar mat-toolbar"]],[[2,"mat-toolbar-multiple-rows",null],[2,"mat-toolbar-single-row",null]],null,null,b.b,b.a)),o.pb(2,4243456,null,1,d.a,[o.k,u.a,a.d],null,null),o.Hb(603979776,1,{_toolbarRows:1}),(n()(),o.qb(4,0,null,0,1,"app-contact",[],null,null,null,p.b,p.a)),o.pb(5,114688,null,0,v.a,[o.h,h.a,m.a,o.z],{context:[0,"context"]},null),(n()(),o.qb(6,0,null,0,0,"span",[["class","example-spacer"]],null,null,null,null,null)),(n()(),o.qb(7,0,null,0,1,"mat-icon",[["class","mat-icon notranslate"],["role","img"]],[[2,"mat-icon-inline",null],[2,"mat-icon-no-color",null]],null,null,g.b,g.a)),o.pb(8,9158656,null,0,f.b,[o.k,f.d,[8,null],[2,f.a],[2,o.l]],{svgIcon:[0,"svgIcon"]},null),(n()(),o.qb(9,0,null,0,1,"mat-icon",[["class","mat-icon notranslate"],["role","img"]],[[2,"mat-icon-inline",null],[2,"mat-icon-no-color",null]],null,null,g.b,g.a)),o.pb(10,9158656,null,0,f.b,[o.k,f.d,[8,null],[2,f.a],[2,o.l]],{svgIcon:[0,"svgIcon"]},null),(n()(),o.qb(11,0,null,null,0,"video",[["autoplay",""],["class","video-element"],["playsinline",""]],[[8,"src",4]],[[null,"loadeddata"],[null,"ended"],[null,"error"]],(function(n,l,t){var o=!0,e=n.component;return"loadeddata"===l&&(o=!1!==e.onLoadedData()&&o),"ended"===l&&(o=!1!==e.onEnded()&&o),"error"===l&&(o=!1!==e.onErrorVideo(t)&&o),o}),null,null))],(function(n,l){var t=l.component;n(l,5,0,t.context.contact),n(l,8,0,t.video),n(l,10,0,t.audio)}),(function(n,l){var t=l.component;n(l,1,0,o.Cb(l,2)._toolbarRows.length>0,0===o.Cb(l,2)._toolbarRows.length),n(l,7,0,o.Cb(l,8).inline,"primary"!==o.Cb(l,8).color&&"accent"!==o.Cb(l,8).color&&"warn"!==o.Cb(l,8).color),n(l,9,0,o.Cb(l,10).inline,"primary"!==o.Cb(l,10).color&&"accent"!==o.Cb(l,10).color&&"warn"!==o.Cb(l,10).color),n(l,11,0,t.context.src)}))}function P(n){return o.Lb(0,[(n()(),o.qb(0,0,null,null,6,"div",[["class","video-block-container"]],null,null,null,null,null)),o.Gb(512,null,a.y,a.z,[o.q,o.r,o.k,o.C]),o.pb(2,278528,null,0,a.j,[a.y],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),(n()(),o.gb(16777216,null,null,1,null,w)),o.pb(4,16384,null,0,a.l,[o.N,o.K],{ngIf:[0,"ngIf"]},null),(n()(),o.gb(16777216,null,null,1,null,O)),o.pb(6,16384,null,0,a.l,[o.N,o.K],{ngIf:[0,"ngIf"]},null)],(function(n,l){var t=l.component;n(l,2,0,"video-block-container",t.context.className),n(l,4,0,!t.startBlock),n(l,6,0,t.context.className.active)}),null)}var M=t("cUpR"),q=o.ob({encapsulation:0,styles:[["div.video-player-container[_ngcontent-%COMP%]{display:flex;justify-content:stretch;align-items:stretch;width:100%;height:100%}div.video-player-stop[_ngcontent-%COMP%]{position:absolute;top:0;left:0;display:flex;justify-content:center;align-items:center;z-index:6;height:100%;width:100%;background-color:#3e3e3e91}div.video-metadata-container.fixed[_ngcontent-%COMP%]{flex:initial}div.video-metadata-container[_ngcontent-%COMP%]{flex:1 1 0}div.stop-block-round[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer;width:0;height:0;border-radius:50%;background-color:rgba(255,255,255,.45)}mat-icon.video-stop[_ngcontent-%COMP%]{width:48px;height:48px;top:0;color:#b00000}.stop-block-round[_ngcontent-%COMP%]{-webkit-animation:.2s forwards buttonEscalation;animation:.2s forwards buttonEscalation}@-webkit-keyframes buttonEscalation{from{width:10px;height:10px}to{width:80px;height:80px}}@keyframes buttonEscalation{from{width:10px;height:10px}to{width:80px;height:80px}}@media (orientation:landscape){div.video-player-container[_ngcontent-%COMP%]{flex-direction:row}}@media (orientation:portrait){div.video-player-container[_ngcontent-%COMP%]{flex-direction:column}}"]],data:{}});function j(n){return o.Lb(0,[(n()(),o.qb(0,0,null,null,4,"div",[["class","video-metadata-container"]],null,null,null,null,null)),o.Gb(512,null,a.y,a.z,[o.q,o.r,o.k,o.C]),o.pb(2,278528,null,0,a.j,[a.y],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),(n()(),o.qb(3,0,null,null,1,"app-video-block",[],null,null,null,P,y)),o.pb(4,114688,null,0,k,[x,C.o,h.a],{context:[0,"context"]},null)],(function(n,l){n(l,2,0,"video-metadata-container",l.context.$implicit.className),n(l,4,0,l.context.$implicit)}),null)}function _(n){return o.Lb(0,[(n()(),o.qb(0,0,null,null,3,"div",[["class","video-player-stop"]],null,[[null,"click"]],(function(n,l,t){var o=!0;return"click"===l&&(o=!1!==n.component.onClickOverlay(t)&&o),o}),null,null)),(n()(),o.qb(1,0,null,null,2,"div",[["class","stop-block-round"]],null,[[null,"click"]],(function(n,l,t){var o=!0;return"click"===l&&(o=!1!==n.component.onClickButton()&&o),o}),null,null)),(n()(),o.qb(2,0,null,null,1,"mat-icon",[["class","video-stop mat-icon notranslate"],["role","img"],["svgIcon","video-stop"]],[[2,"mat-icon-inline",null],[2,"mat-icon-no-color",null]],null,null,g.b,g.a)),o.pb(3,9158656,null,0,f.b,[o.k,f.d,[8,null],[2,f.a],[2,o.l]],{svgIcon:[0,"svgIcon"]},null)],(function(n,l){n(l,3,0,"video-stop")}),(function(n,l){n(l,2,0,o.Cb(l,3).inline,"primary"!==o.Cb(l,3).color&&"accent"!==o.Cb(l,3).color&&"warn"!==o.Cb(l,3).color)}))}function I(n){return o.Lb(0,[(n()(),o.qb(0,0,null,null,3,"div",[["class","video-player-container"]],null,null,null,null,null)),(n()(),o.gb(16777216,null,null,2,null,j)),o.pb(2,278528,null,0,a.k,[o.N,o.K,o.q],{ngForOf:[0,"ngForOf"]},null),o.Db(131072,a.b,[o.h]),(n()(),o.gb(16777216,null,null,1,null,_)),o.pb(5,16384,null,0,a.l,[o.N,o.K],{ngIf:[0,"ngIf"]},null)],(function(n,l){var t=l.component;n(l,2,0,o.Kb(l,2,0,o.Cb(l,3).transform(t.activeVideoBlocks))),n(l,5,0,t.stopActive)}),null)}function N(n){return o.Lb(0,[(n()(),o.qb(0,0,null,null,1,"app-video-player",[],null,[[null,"click"]],(function(n,l,t){var e=!0;return"click"===l&&(e=!1!==o.Cb(n,1).onClickHost()&&e),e}),I,q)),o.pb(1,114688,null,0,x,[h.a,o.h,M.b,C.o,C.a],null,null)],(function(n,l){n(l,1,0)}),null)}var V=o.mb("app-video-player",x,N,{},{},[]),z=t("NcP4"),B=t("POq0"),T=t("QQfA"),L=t("IP0z"),R=t("JjoW"),E=t("Mz6y"),F=t("Xd0L"),J=t("gavF"),D=t("/Co4"),K=t("s7LF"),U=t("/q54");class H{}var G=t("igqZ"),W=t("HsOI"),Z=t("zMNK"),Q=t("hOhj"),S=t("5GAg"),X=t("Fwaw"),Y=t("oapL"),$=t("ZwOa"),nn=t("8P0U"),ln=t("elxJ"),tn=t("rWV4"),on=t("KPQW"),en=t("mkRZ"),an=t("pBi1"),cn=t("lT8R"),sn=t("7of8"),un=t("VDRc"),rn=t("ura0"),bn=t("Nhcz"),dn=t("u9T3"),pn=t("Gcy5");t.d(l,"VideoPlayerModuleNgFactory",(function(){return vn}));var vn=o.nb(e,[],(function(n){return o.zb([o.Ab(512,o.j,o.Z,[[8,[i.a,V,z.a]],[3,o.j],o.v]),o.Ab(4608,a.n,a.m,[o.s,[2,a.D]]),o.Ab(4608,B.c,B.c,[]),o.Ab(4608,T.c,T.c,[T.i,T.e,o.j,T.h,T.f,o.p,o.x,a.d,L.b,[2,a.h]]),o.Ab(5120,T.j,T.k,[T.c]),o.Ab(5120,R.a,R.b,[T.c]),o.Ab(5120,E.b,E.c,[T.c]),o.Ab(4608,M.e,F.c,[[2,F.g],[2,F.l]]),o.Ab(4608,F.b,F.b,[]),o.Ab(5120,J.a,J.d,[T.c]),o.Ab(5120,D.b,D.c,[T.c]),o.Ab(4608,K.e,K.e,[]),o.Ab(4608,K.w,K.w,[]),o.Ab(5120,o.b,(function(n,l){return[U.j(n,l)]}),[a.d,o.z]),o.Ab(1073742336,a.c,a.c,[]),o.Ab(1073742336,C.s,C.s,[[2,C.x],[2,C.o]]),o.Ab(1073742336,H,H,[]),o.Ab(1073742336,L.a,L.a,[]),o.Ab(1073742336,F.l,F.l,[[2,F.d],[2,M.f]]),o.Ab(1073742336,d.b,d.b,[]),o.Ab(1073742336,f.c,f.c,[]),o.Ab(1073742336,G.c,G.c,[]),o.Ab(1073742336,B.d,B.d,[]),o.Ab(1073742336,W.e,W.e,[]),o.Ab(1073742336,Z.e,Z.e,[]),o.Ab(1073742336,u.b,u.b,[]),o.Ab(1073742336,Q.b,Q.b,[]),o.Ab(1073742336,T.g,T.g,[]),o.Ab(1073742336,F.v,F.v,[]),o.Ab(1073742336,F.t,F.t,[]),o.Ab(1073742336,F.q,F.q,[]),o.Ab(1073742336,R.d,R.d,[]),o.Ab(1073742336,S.a,S.a,[]),o.Ab(1073742336,E.e,E.e,[]),o.Ab(1073742336,X.c,X.c,[]),o.Ab(1073742336,Y.c,Y.c,[]),o.Ab(1073742336,$.b,$.b,[]),o.Ab(1073742336,nn.c,nn.c,[]),o.Ab(1073742336,s.c,s.c,[]),o.Ab(1073742336,ln.d,ln.d,[]),o.Ab(1073742336,tn.j,tn.j,[]),o.Ab(1073742336,on.b,on.b,[]),o.Ab(1073742336,J.c,J.c,[]),o.Ab(1073742336,J.b,J.b,[]),o.Ab(1073742336,D.e,D.e,[]),o.Ab(1073742336,en.a,en.a,[]),o.Ab(1073742336,an.d,an.d,[]),o.Ab(1073742336,an.c,an.c,[]),o.Ab(1073742336,cn.a,cn.a,[]),o.Ab(1073742336,sn.a,sn.a,[]),o.Ab(1073742336,K.v,K.v,[]),o.Ab(1073742336,K.s,K.s,[]),o.Ab(1073742336,U.c,U.c,[]),o.Ab(1073742336,un.a,un.a,[]),o.Ab(1073742336,rn.c,rn.c,[]),o.Ab(1073742336,bn.a,bn.a,[]),o.Ab(1073742336,dn.a,dn.a,[[2,U.g],o.z]),o.Ab(1073742336,pn.a,pn.a,[]),o.Ab(1073742336,e,e,[]),o.Ab(1024,C.m,(function(){return[[{path:"",component:x}]]}),[])])}))}}]);
//# sourceMappingURL=19-es2015.090e5363c4d903cc9086.js.map